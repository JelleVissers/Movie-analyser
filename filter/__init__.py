import matplotlib.pyplot as plt
import numpy as np
import math

def remove_range(list,boven,onder):
    newlist = []

    for nummer in range(0,len(list),1):
        if len(newlist) == 0:
            newlist = newlist + [list[nummer]]
        else:
            if list[nummer] > onder and list[nummer] < boven:
                newlist = newlist + [newlist[nummer-1]]
            else:
                newlist = newlist + [list[nummer]]

    return newlist

def gemmidelde(list,sampels):
    gem_list = []

    for teller in range(sampels,len(list)-sampels,1):
        value = 0

        for nummer in range(teller-sampels,teller+sampels,1):
            value = value+list[nummer]

        value = value/(sampels*2)

        gem_list = gem_list+[value]

    return gem_list

def split_xyt(list):
    x_list = []
    y_list = []
    t_list = []

    for point in list:
        x_list = x_list+[point[0]]
        y_list = y_list+[point[1]]
        t_list = t_list+[point[2]]

    return x_list,y_list,t_list

def combine_xyt(x,y,t):
    new_list = []

    if len(x) == len(t) & len(y) == len(t):
        for point in range(0,len(x),1):
            new_list = new_list + [[x[point],y[point],t[point]]]

        return new_list
    else:return None

def offset(list,offset):
    newlist = []

    for point in list:
        newlist = newlist +[point+offset]

    return newlist

def cal_speed(list):
    x,y,t = split_xyt(list)

    speed_x = []
    speed_y = []

    for point in range(1,len(list),1):
        delta_x = (x[point]-x[point-1])/1000
        delta_y = (y[point]-y[point-1])/1000
        delta_t = (t[point]-t[point-1])/1000

        speed_x = speed_x + [ delta_x / delta_t]
        speed_y = speed_y + [ delta_y / delta_t]

    t.pop(-1)

    return combine_xyt(speed_x,speed_y,t)

def cal_acceleration(list):
    x,y,t = split_xyt(list)

    x = remove_range(x,max(x)/20,-max(x)/20)
    y = remove_range(y,max(y)/20,-max(y)/20)
    remove_from_list(t,0)

    speed_x = []
    speed_y = []

    for point in range(1,len(x),1):
        delta_x = (x[point]-x[point-1])/1000
        delta_y = (y[point]-y[point-1])/1000
        delta_t = (t[point]-t[point-1])/1000

        speed_x = speed_x + [ delta_x/delta_t]
        speed_y = speed_y + [ delta_x/delta_t]


    t = remove_from_list(t,1)

    acc_x = []
    acc_y = []

    for point in range(1,len(speed_x),1):
        delta_x = (speed_x[point]-speed_x[point-1])
        delta_y = (speed_y[point]-speed_y[point-1])
        delta_t = (t[point]-t[point-1])

        acc_x = acc_x + [ delta_x/delta_t]
        acc_y = acc_y + [ delta_x/delta_t]

    t.pop(-1)

    return combine_xyt(acc_x,acc_y,t)

def remove_from_list(list,nummer):
    for data in range(0,nummer,1):
        list.pop(-1)
    return list

def set_offset_zero(list):
    x,y,t = split_xyt(list)

    x = offset(x, -min(x))
    y = offset(y, -min(y))
    t = offset(t, -min(t))

    return combine_xyt(x,y,t)

def position(list):

    place = set_offset_zero(list)

    x,y,t = x,y,t = split_xyt(place)

    x = gemmidelde(x,1)
    y = gemmidelde(y,1)
    t = remove_from_list(t,2)

    return place,combine_xyt(x,y,t)

def copy(list):
    new_list = []
    for x in list:
        new_list = new_list +[x]
    return new_list

def speed(list):
    snelheid = cal_speed(list)
    x,y,t = split_xyt(snelheid)

    x = remove_range(x,max(x)/20,-max(x)/20)
    y = remove_range(y, max(y)/20,-max(y)/20)

    x_gem = gemmidelde(x,4)
    y_gem = gemmidelde(y,4)

    t_gem = copy(t)
    t_gem = remove_from_list(t_gem,8)

    print len(x),len(y),len(t)

    speed_full= combine_xyt(x,y,t)

    speed_gem = combine_xyt(x_gem,y_gem,t_gem)

    return snelheid,speed_full,speed_gem

def acceleration(list):
    versnelling = cal_acceleration(list)
    x,y,t = split_xyt(versnelling)

    x = remove_range(x,max(x)/20,-max(x)/20)
    y = remove_range(y, max(y)/20,-max(y)/20)

    x_gem = gemmidelde(x,2)
    y_gem = gemmidelde(y,2)

    t_gem = copy(t)
    t_gem = remove_from_list(t_gem,4)

    print len(x),len(y),len(t)

    acceleration_full= combine_xyt(x,y,t)

    acceleration_gem = combine_xyt(x_gem,y_gem,t_gem)

    return versnelling,acceleration_full,acceleration_gem


def main(list):
    positie_u,positie = position(list)
    snelheid,speed_full,speed_gem= speed(list)
    versnelling, acceleration_full,acceleration_gem = acceleration(list)

    x_pu,y_pu,t_pu = split_xyt(positie_u)
    x_p , y_p,t_p  = split_xyt(positie)

    x_su,y_su,t_su = split_xyt(snelheid)
    x_s ,y_s ,t_s  = split_xyt(speed_full)
    x_g ,y_g ,t_g  = split_xyt(speed_gem)

    x_au,y_au,t_au = split_xyt(versnelling)
    x_a ,y_a ,t_a  = split_xyt(acceleration_full)
    x_ag ,y_ag ,t_ag  = split_xyt(acceleration_gem)


    dev = 2
    up_list_X   = offset(x_g, dev)
    down_list_X = offset(x_g,-dev)

    up_list_Y   = offset(y_g, dev)
    down_list_Y = offset(y_g,-dev)

    a_up_list_X   = offset(x_ag, 2)
    a_down_list_X = offset(x_ag,-2)

    plt.figure("Place X")
    plt.plot(t_pu,x_pu,'gx',t_p,x_p,"black")

    plt.figure("Place Y")
    plt.plot(t_pu,y_pu,'gx',t_p,y_p,"black")

    plt.figure("Speed X")
    plt.plot(t_su,x_su,'gx',t_s,x_s,"rx",t_g,x_g,'b',t_g,up_list_X,'black',t_g,down_list_X,'black')

    plt.figure("acceleration X")
    plt.plot(t_au, x_au, 'gx', t_a, x_a, "rx", t_ag, x_ag, 'b', t_ag, a_up_list_X, 'black', t_ag, a_down_list_X,'black')

    plt.figure("Speed Y")
    plt.plot(t_su,y_su,'gx',t_s,y_s,"rx",t_g,y_g,'b',t_g,up_list_Y,'black',t_g,down_list_Y,'black')
    plt.show()


if __name__ == '__main__':
    test_list_2 = [[3055.929591949627, 1950.3759366820545, 4.166666666666667],
                   [3095.712206216073, 1950.505211105145, 8.333333333333334],
                   [3137.3979095306368, 1953.3201843742193, 12.5],
                   [3179.928286476166, 1956.5338799271576, 16.666666666666668],
                   [3217.5480518466916, 1955.0012060000026, 20.833333333333336],
                   [3217.5147493021013, 1955.0045362544615, 25.0],
                   [3256.88774227009, 1955.2632364758451, 29.166666666666668],
                   [3296.3791106465756, 1956.0411536424278, 33.333333333333336],
                   [3333.8405375550956, 1955.7308344769297, 37.5],
                   [3369.717066091536, 1953.9436988340663, 41.66666666666667],
                   [3410.256253620986, 1957.6505747973426, 45.833333333333336],
                   [3410.256253620986, 1957.6505747973426, 50.0],
                   [3446.937795485289, 1957.0496152426952, 54.16666666666667],
                   [3486.2478163689616, 1958.6629721528795, 58.333333333333336],
                   [3522.0967946185133, 1957.1608760166664, 62.50000000000001],
                   [3561.771932491055, 1959.9143909534516, 66.66666666666667],
                   [3597.9018631167846, 1958.7963337064425, 70.83333333333334],
                   [3597.923661145971, 1958.8085950978598, 75.0],
                   [3636.9136748511737, 1960.5671208274161, 79.16666666666667],
                   [3668.659476856828, 1955.8908380661646, 83.33333333333334],
                   [3707.5574544388, 1957.760775944895, 87.5],
                   [3741.8978274184233, 1956.6023015187698, 91.66666666666667],
                   [3781.9296052684836, 1961.1101036794364, 95.83333333333333],
                   [3781.8953944726777, 1961.1087413026123, 100.0],
                   [3816.5158115772624, 1960.9040820285863, 104.16666666666667],
                   [3852.7068977848758, 1962.7329972273901, 108.33333333333334],
                   [3886.4720449943075, 1961.926167397095, 112.50000000000001],
                   [3919.550857034779, 1962.0278915332974, 116.66666666666667],
                   [3954.0828710209976, 1963.8555957304795, 120.83333333333334],
                   [3955.8451811306213, 1962.6960616779356, 125.00000000000001],
                   [3986.7236032249075, 1965.0323865561293, 129.16666666666666],
                   [4018.5126985385286, 1965.8122716003468, 133.33333333333334],
                   [4045.5882727910384, 1964.3156249714302, 137.5],
                   [4079.3343467249324, 1969.8598931448603, 141.66666666666669],
                   [4109.106821588424, 1972.0887416291498, 145.83333333333334],
                   [4109.055959520323, 1972.0566500861812, 150.0],
                   [4131.832175266259, 1968.8630874351995, 154.16666666666669],
                   [4160.9852228003765, 1974.1133849650212, 158.33333333333334],
                   [4187.4922317916125, 1979.2630179850596, 162.5],
                   [4206.533113036168, 1972.5969081845533, 166.66666666666669],
                   [4231.794304109331, 1977.4275936525405, 170.83333333333334],
                   [4231.794304109331, 1977.4275936525405, 175.0],
                   [4249.897264598069, 1979.6305569771714, 179.16666666666669],
                   [4269.008383936669, 1975.2650475070259, 183.33333333333334],
                   [4286.11135983649, 1974.7244866582485, 187.5],
                   [4305.839787251627, 1975.1260850709637, 191.66666666666666],
                   [4325.76833268471, 1976.5506771034038, 195.83333333333334],
                   [4325.9766249636, 1976.9268444820686, 200.0],
                   [4345.143450376787, 1978.6217926264987, 204.16666666666669],
                   [4360.973360822052, 1978.209446574393, 208.33333333333334],
                   [4375.763929125704, 1979.1193629177144, 212.50000000000003],
                   [4388.906929723364, 1980.4098365205782, 216.66666666666669],
                   [4399.474432622593, 1981.0931441854848, 220.83333333333334],
                   [4399.598257538387, 1981.3308032536954, 225.00000000000003],
                   [4409.391930401505, 1980.2949427417427, 229.16666666666669],
                   [4417.795070652787, 1979.5519932469795, 233.33333333333334],
                   [4425.856102946008, 1979.6858089261502, 237.50000000000003],
                   [4430.164543964743, 1976.5888236544797, 241.66666666666669],
                   [4433.804209338028, 1974.0505642559083, 245.83333333333334],
                   [4437.640965225206, 1978.525972123201, 250.00000000000003],
                   [4439.048149109337, 1974.7850367393212, 254.16666666666666],
                   [4440.190729139181, 1971.8205047699973, 258.3333333333333],
                   [4444.252125827138, 1972.947341778762, 262.5],
                   [4443.319049077807, 1969.0491275592956, 266.6666666666667],
                   [4444.165539211204, 1967.2256618677884, 270.83333333333337],
                   [4444.167658464042, 1967.2813679423755, 275.0],
                   [4439.178331783643, 1960.0367021172185, 279.1666666666667],
                   [4437.381508127809, 1957.1245459680226, 283.33333333333337],
                   [4439.394192822669, 1950.2188092216707, 287.5],
                   [4427.9683925242325, 1945.2520374464723, 291.6666666666667],
                   [4428.776130605744, 1945.8946251818572, 295.83333333333337],
                   [4428.770681098447, 1945.8784280351704, 300.0],
                   [4424.568505471995, 1940.405608957406, 304.1666666666667],
                   [4419.756287778735, 1934.7901944387154, 308.33333333333337],
                   [4415.011280675466, 1929.3587007912831, 312.5],
                   [4410.239026035713, 1924.0575411933603, 316.6666666666667],
                   [4404.9327196809, 1918.082459193097, 320.8333333333333],
                   [4404.864298089287, 1918.0129779750662, 325.0],
                   [4397.574068328123, 1909.8046576096358, 329.1666666666667],
                   [4392.083386976442, 1904.0128909798204, 333.33333333333337],
                   [4388.749499512574, 1894.822145548984, 337.5],
                   [4378.801726693126, 1891.7717838397396, 341.6666666666667],
                   [4372.315299258203, 1886.12821353335, 345.83333333333337],
                   [4372.315299258203, 1886.12821353335, 350.0],
                   [4363.950305557996, 1878.2050840497725, 354.1666666666667],
                   [4359.403902720645, 1876.2844354781435, 358.33333333333337],
                   [4350.517875572808, 1867.5852053304154, 362.5],
                   [4344.953020371813, 1864.6274852452123, 366.6666666666667],
                   [4335.739417285372, 1856.3907063416777, 370.83333333333337],
                   [4335.655858173492, 1856.3242526277002, 375.0],
                   [4328.051373491559, 1850.1370939684796, 379.1666666666667],
                   [4320.286128344379, 1844.6515593736901, 383.3333333333333],
                   [4312.757028513383, 1838.386139734683, 387.5],
                   [4305.271827491164, 1832.91453165854, 391.6666666666667],
                   [4297.654021791396, 1826.4800259181372, 395.83333333333337],
                   [4297.6431227768035, 1826.4909249327302, 400.0],
                   [4289.589053742906, 1820.3847520069446, 404.1666666666667],
                   [4282.071458427314, 1815.566025179969, 408.33333333333337],
                   [4274.390075142419, 1810.3455485650757, 412.50000000000006],
                   [4266.383840672569, 1804.9155686696704, 416.6666666666667],
                   [4258.8075117783355, 1799.363731736106, 420.83333333333337],
                   [4258.773603732935, 1799.337089700434, 425.00000000000006],
                   [4251.224522375185, 1794.4013498417853, 429.1666666666667],
                   [4243.761724882963, 1789.2968266321463, 433.33333333333337],
                   [4236.225661792643, 1785.0219909084071, 437.50000000000006],
                   [4228.775579817448, 1780.811943771416, 441.6666666666667],
                   [4222.161088961056, 1776.3858842201976, 445.8333333333333],
                   [4222.18561174389, 1776.3457697914869, 450.00000000000006],
                   [4215.328617812802, 1771.798610078123, 454.1666666666667],
                   [4206.847670707341, 1766.0306093551287, 458.33333333333337],
                   [4200.9694688367945, 1763.664312186804, 462.5],
                   [4194.262033605955, 1760.095793158779, 466.6666666666667],
                   [4187.547332365389, 1756.1797166653962, 470.83333333333337],
                   [4187.532800345931, 1756.167909399587, 475.00000000000006],
                   [4181.118124757079, 1752.251832906204, 479.1666666666667],
                   [4174.349231193952, 1748.4430814315228, 483.33333333333337],
                   [4167.913060326319, 1744.7743520193224, 487.50000000000006],
                   [4161.657631450689, 1741.5220557897, 491.6666666666667],
                   [4155.033452581326, 1738.1205036102333, 495.83333333333337],
                   [4155.061305618619, 1738.0222611036927, 500.00000000000006],
                   [4147.11380472741, 1732.9593660747912, 504.1666666666667],
                   [4141.975222097168, 1730.6666372549698, 508.3333333333333],
                   [4135.738260996265, 1727.0418066515472, 512.5000000000001],
                   [4129.34205318214, 1723.543374342364, 516.6666666666666],
                   [4122.802644426279, 1720.2267436516017, 520.8333333333333],
                   [4122.829286461951, 1720.2358261637628, 525.0],
                   [4116.500894738628, 1717.6694109774924, 529.1666666666667],
                   [4110.274227151507, 1714.2337993774222, 533.3333333333334],
                   [4103.99639474588, 1711.0381174736028, 537.5],
                   [4097.309546542607, 1707.471869073618, 541.6666666666667],
                   [4091.127988765885, 1704.890619117485, 545.8333333333335],
                   [4091.157961056016, 1704.8488395615448, 550.0],
                   [4084.5985707734008, 1701.8823397145861, 554.1666666666667],
                   [4078.2014547080603, 1699.4623043493093, 558.3333333333334],
                   [4071.822200916636, 1696.4576579512745, 562.5],
                   [4065.993347362164, 1694.8340075273077, 566.6666666666667],
                   [4058.91140987989, 1690.5081583602648, 570.8333333333334],
                   [4058.8659973190856, 1690.4936263408072, 575.0],
                   [4052.85519077099, 1687.350774382724, 579.1666666666666],
                   [4046.8162284351947, 1684.101657032358, 583.3333333333334],
                   [4040.568973820509, 1681.641658613573, 587.5],
                   [4034.335645724471, 1678.0794973440607, 591.6666666666667],
                   [4028.265197346518, 1675.8162866887624, 595.8333333333334],
                   [4028.232197552333, 1675.749832974785, 600.0],
                   [4020.8466014134797, 1671.8296693509299, 604.1666666666667],
                   [4016.1915111806034, 1672.382188840719, 608.3333333333334],
                   [4008.8492083497167, 1667.945533025313, 612.5],
                   [4002.6734028306973, 1665.4769062199753, 616.6666666666667],
                   [3995.445539653038, 1661.5092107824778, 620.8333333333334],
                   [3996.629899238822, 1663.0252334373379, 625.0],
                   [3991.144364644032, 1662.5847315975334, 629.1666666666667],
                   [3983.815988331792, 1658.4851883585, 633.3333333333334],
                   [3978.4494346463107, 1658.2729603243397, 637.5],
                   [3972.4655728842918, 1655.941479452632, 641.6666666666666],
                   [3965.483845786194, 1653.0391626916103, 645.8333333333334],
                   [3965.5162400795675, 1652.9861813706716, 650.0],
                   [3959.522387554172, 1651.340430167113, 654.1666666666667],
                   [3953.7153320288858, 1648.808225776649, 658.3333333333334],
                   [3947.5931133316158, 1646.4752311529144, 662.5],
                   [3941.584123285952, 1644.0229528694663, 666.6666666666667],
                   [3937.4140392024688, 1645.4573842900807, 670.8333333333334],
                   [3937.4140392024688, 1645.4573842900807, 675.0],
                   [3929.6048952465108, 1640.3545262076711, 679.1666666666667],
                   [3923.220797448601, 1637.829436451733, 683.3333333333334],
                   [3918.3126078768405, 1638.0275865920437, 687.5],
                   [3911.0175341091904, 1633.4911745180702, 691.6666666666667],
                   [3906.236499707683, 1633.0031408646234, 695.8333333333334],
                   [3899.142149458789, 1628.6795623256207, 700.0],
                   [3897.9620283786803, 1626.9328438618734, 704.1666666666666],
                   [3894.457389686187, 1628.9338726661265, 708.3333333333334],
                   [3887.728761926973, 1624.652073683064, 712.5],
                   [3883.466338969854, 1625.9074282389056, 716.6666666666667],
                   [3876.0062662312807, 1620.9990872919425, 720.8333333333334],
                   [3869.657892981204, 1619.1731995971925, 725.0],
                   [3869.6821130136327, 1619.1417135550346, 729.1666666666667],
                   [3864.0028181594103, 1617.2136475984742, 733.3333333333334],
                   [3859.0552710349525, 1617.7884192430577, 737.5],
                   [3852.1904055933246, 1616.1594706869969, 741.6666666666667],
                   [3846.4281571280326, 1614.9333315452727, 745.8333333333334],
                   [3838.8736262629855, 1611.7311405077382, 750.0],
                   [3838.897240794604, 1611.7152461114565, 754.1666666666667],
                   [3832.6639126985656, 1610.4766942031126, 758.3333333333334],
                   [3826.744234022484, 1609.3064125111782, 762.5],
                   [3820.7167762020927, 1607.7593579397685, 766.6666666666666],
                   [3812.7102389818374, 1604.1862976556629, 770.8333333333334],
                   [3808.762070945486, 1605.3944231482678, 775.0],
                   [3809.8758896868203, 1607.4880935765623, 779.1666666666667],
                   [3802.774273428198, 1603.7892404990282, 783.3333333333334],
                   [3795.209146298963, 1600.123689966084, 787.5],
                   [3790.628229915401, 1601.1500138402678, 791.6666666666667],
                   [3784.5456715212335, 1599.9883605348864, 795.8333333333334],
                   [3778.8339823736374, 1598.7272537213428, 800.0],
                   [3778.7819093039147, 1598.713781328304, 804.1666666666667],
                   [3772.7029839146117, 1597.7119802369548, 808.3333333333334],
                   [3766.7539384492097, 1596.2168473600648, 812.5000000000001],
                   [3762.638954939503, 1598.4441820923273, 816.6666666666667],
                   [3754.8619025265134, 1593.665872444468, 820.8333333333334],
                   [3747.5292877085985, 1590.3645306491767, 825.0000000000001],
                   [3747.5377647199484, 1590.4137275900484, 829.1666666666666],
                   [3742.8106198905957, 1591.935653877813, 833.3333333333334],
                   [3742.1475965028485, 1584.4507556059998, 837.5000000000001],
                   [3731.0841884396336, 1589.528939530372, 841.6666666666667],
                   [3722.7352405109114, 1585.3432638010129, 845.8333333333334],
                   [3719.217583550988, 1587.8843993284352, 850.0000000000001],
                   [3719.2151615477446, 1587.9065001080266, 854.1666666666667],
                   [3713.316069899228, 1586.367922547967, 858.3333333333334],
                   [3710.324593143827, 1591.8445260057983, 862.4999999999999],
                   [3699.2950931260125, 1581.6239750711165, 866.6666666666667],
                   [3695.644528738134, 1584.313155546762, 870.8333333333334],
                   [3689.5298788009977, 1584.0614185847019, 875.0000000000001],
                   [3689.5298788009977, 1584.0614185847019, 879.1666666666667],
                   [3681.180325371465, 1579.7084732563787, 883.3333333333334],
                   [3676.2079527137676, 1580.6601691556405, 887.5000000000001],
                   [3671.8816494211164, 1582.6088221397654, 891.6666666666666],
                   [3666.17843728487, 1582.1922375819847, 895.8333333333334],
                   [3401.903975437805, 1998.554727940459, 900.0000000000001],
                   [3401.9091221946965, 1998.5497325587705, 904.1666666666667],
                   [3401.9091221946965, 1998.5497325587705, 908.3333333333334]]

    main(test_list_2)


